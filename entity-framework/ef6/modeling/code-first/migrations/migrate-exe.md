---
title: Uso de migrate.exe - EF6
author: divega
ms.date: 10/23/2016
ms.assetid: 989ea862-e936-4c85-926a-8cfbef5df5b8
ms.openlocfilehash: 6e9880523bbcf2fe55390a447241e59723a0967f
ms.sourcegitcommit: 2b787009fd5be5627f1189ee396e708cd130e07b
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/13/2018
ms.locfileid: "45490231"
---
# <a name="using-migrateexe"></a><span data-ttu-id="0d267-102">Uso de migrate.exe</span><span class="sxs-lookup"><span data-stu-id="0d267-102">Using migrate.exe</span></span>
<span data-ttu-id="0d267-103">Migraciones de Code First puede usarse para actualizar una base de datos desde dentro de visual studio, pero también se pueden ejecutar a través de la migrate.exe herramienta línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="0d267-103">Code First Migrations can be used to update a database from inside visual studio, but can also be executed via the command line tool migrate.exe.</span></span> <span data-ttu-id="0d267-104">Esta página proporcionan una visión general rápida sobre cómo usar migrate.exe para ejecutar migraciones en comparación con una base de datos.</span><span class="sxs-lookup"><span data-stu-id="0d267-104">This page will give a quick overview on how to use migrate.exe to execute migrations against a database.</span></span>

> [!NOTE]
> <span data-ttu-id="0d267-105">En este artículo se supone que sabe cómo usar migraciones de Code First en escenarios básicos.</span><span class="sxs-lookup"><span data-stu-id="0d267-105">This article assumes you know how to use Code First Migrations in basic scenarios.</span></span> <span data-ttu-id="0d267-106">Si no lo hace, necesitará leer [migraciones de Code First](~/ef6/modeling/code-first/migrations/index.md) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="0d267-106">If you don’t, then you’ll need to read [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) before continuing.</span></span>

## <a name="copy-migrateexe"></a><span data-ttu-id="0d267-107">Copiar migrate.exe</span><span class="sxs-lookup"><span data-stu-id="0d267-107">Copy migrate.exe</span></span>

<span data-ttu-id="0d267-108">Al instalar Entity Framework mediante NuGet migrate.exe estará dentro de la carpeta de herramientas del paquete descargado.</span><span class="sxs-lookup"><span data-stu-id="0d267-108">When you install Entity Framework using NuGet migrate.exe will be inside the tools folder of the downloaded package.</span></span> <span data-ttu-id="0d267-109">En &lt;carpeta del proyecto&gt;\\paquetes\\EntityFramework.&lt; versión&gt;\\herramientas</span><span class="sxs-lookup"><span data-stu-id="0d267-109">In &lt;project folder&gt;\\packages\\EntityFramework.&lt;version&gt;\\tools</span></span>

<span data-ttu-id="0d267-110">Una vez que tenga migrate.exe debe copiarlo en la ubicación del ensamblado que contiene las migraciones.</span><span class="sxs-lookup"><span data-stu-id="0d267-110">Once you have migrate.exe then you need to copy it to the location of the assembly that contains your migrations.</span></span>

<span data-ttu-id="0d267-111">Si la aplicación está destinada a .NET 4 y 4.5 no, a continuación, deberá copiar el **Redirect.config** en la ubicación de así y cámbiele el nombre **migrate.exe.config**. Esto es para que migrate.exe obtiene las redirecciones de enlace correcto para poder localizar el ensamblado de Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="0d267-111">If your application targets .NET 4, and not 4.5, then you will need to copy the **Redirect.config** into the location as well and rename it **migrate.exe.config**. This is so that migrate.exe gets the correct binding redirects to be able to locate the Entity Framework assembly.</span></span>

| <span data-ttu-id="0d267-112">.NET 4.5</span><span class="sxs-lookup"><span data-stu-id="0d267-112">.NET 4.5</span></span>                                   | <span data-ttu-id="0d267-113">.NET 4.0</span><span class="sxs-lookup"><span data-stu-id="0d267-113">.NET 4.0</span></span>                                   |
|:-------------------------------------------|:-------------------------------------------|
| ![Archivos de .NET Framework 4.5](~/ef6/media/net45files.png)  | ![Archivos de .NET 4.0](~/ef6/media/net40files.png)  |

> [!NOTE]
> <span data-ttu-id="0d267-116">Migrate.exe no es compatible con x64 ensamblados.</span><span class="sxs-lookup"><span data-stu-id="0d267-116">migrate.exe doesn't support x64 assemblies.</span></span>

<span data-ttu-id="0d267-117">Una vez haya movido migrate.exe a la carpeta correcta, a continuación, podrá usarlo para ejecutar migraciones en comparación con la base de datos.</span><span class="sxs-lookup"><span data-stu-id="0d267-117">Once you have moved migrate.exe to the correct folder then you should be able to use it to execute migrations against the database.</span></span> <span data-ttu-id="0d267-118">Todo está diseñada para hacer es ejecutar migraciones.</span><span class="sxs-lookup"><span data-stu-id="0d267-118">All the utility is designed to do is execute migrations.</span></span> <span data-ttu-id="0d267-119">Que no se puede generar las migraciones o crear una secuencia de comandos SQL.</span><span class="sxs-lookup"><span data-stu-id="0d267-119">It cannot generate migrations or create a SQL script.</span></span>

## <a name="see-options"></a><span data-ttu-id="0d267-120">Vea las opciones</span><span class="sxs-lookup"><span data-stu-id="0d267-120">See options</span></span>

``` console
Migrate.exe /?
```

<span data-ttu-id="0d267-121">Lo anterior mostrará la página de ayuda asociada con esta utilidad, tenga en cuenta que deberá tener EntityFramework.dll en la misma ubicación que se está ejecutando migrate.exe en orden para que funcione.</span><span class="sxs-lookup"><span data-stu-id="0d267-121">The above will display the help page associated with this utility, note that you will need to have the EntityFramework.dll in the same location that you are running migrate.exe in order for this to work.</span></span>

## <a name="migrate-to-the-latest-migration"></a><span data-ttu-id="0d267-122">Migrar a la migración más reciente</span><span class="sxs-lookup"><span data-stu-id="0d267-122">Migrate to the latest migration</span></span>

``` console
Migrate.exe MyMvcApplication.dll /startupConfigurationFile=”..\\web.config”
```

<span data-ttu-id="0d267-123">Cuando ejecuta migrate.exe el parámetro obligatorio solo es el ensamblado, que es el ensamblado que contiene las migraciones que está intentando ejecutar, pero usará la convención de todos los según la configuración si no especifica el archivo de configuración.</span><span class="sxs-lookup"><span data-stu-id="0d267-123">When running migrate.exe the only mandatory parameter is the assembly, which is the assembly that contains the migrations that you are trying to run, but it will use all convention based settings if you do not specify the configuration file.</span></span>

## <a name="migrate-to-a-specific-migration"></a><span data-ttu-id="0d267-124">Migrar a una migración específica</span><span class="sxs-lookup"><span data-stu-id="0d267-124">Migrate to a specific migration</span></span>

``` console
Migrate.exe MyApp.exe /startupConfigurationFile=”MyApp.exe.config” /targetMigration=”AddTitle”
```

<span data-ttu-id="0d267-125">Si desea ejecutar las migraciones hasta una migración específica, a continuación, puede especificar el nombre de la migración.</span><span class="sxs-lookup"><span data-stu-id="0d267-125">If you want to run migrations up to a specific migration, then you can specify the name of the migration.</span></span> <span data-ttu-id="0d267-126">Esto ejecutará todas las migraciones anteriores según sea necesario hasta llegar a la migración especificada.</span><span class="sxs-lookup"><span data-stu-id="0d267-126">This will run all previous migrations as required until getting to the migration specified.</span></span>

## <a name="specify-working-directory"></a><span data-ttu-id="0d267-127">Especificar directorio de trabajo</span><span class="sxs-lookup"><span data-stu-id="0d267-127">Specify working directory</span></span>

``` console
Migrate.exe MyApp.exe /startupConfigurationFile=”MyApp.exe.config” /startupDirectory=”c:\\MyApp”
```

<span data-ttu-id="0d267-128">Si el ensamblado tiene dependencias o lee los archivos en relación con el directorio de trabajo, a continuación, deberá establecer startupDirectory.</span><span class="sxs-lookup"><span data-stu-id="0d267-128">If you assembly has dependencies or reads files relative to the working directory then you will need to set startupDirectory.</span></span>

## <a name="specify-migration-configuration-to-use"></a><span data-ttu-id="0d267-129">Especifique la configuración de migración que se usará</span><span class="sxs-lookup"><span data-stu-id="0d267-129">Specify migration configuration to use</span></span>

``` console
Migrate.exe MyAssembly CustomConfig /startupConfigurationFile=”..\\web.config”
```

<span data-ttu-id="0d267-130">Si tiene varias clases de configuración de migración, las clases que heredan de DbMigrationConfiguration, a continuación, deberá especificar que es que se usará para esta ejecución.</span><span class="sxs-lookup"><span data-stu-id="0d267-130">If you have multiple migration configuration classes, classes inheriting from DbMigrationConfiguration, then you need to specify which is to be used for this execution.</span></span> <span data-ttu-id="0d267-131">Esto se especifica al proporcionar el segundo parámetro opcional sin un modificador como anteriormente.</span><span class="sxs-lookup"><span data-stu-id="0d267-131">This is specified by providing the optional second parameter without a switch as above.</span></span>

## <a name="provide-connection-string"></a><span data-ttu-id="0d267-132">Proporcionar la cadena de conexión</span><span class="sxs-lookup"><span data-stu-id="0d267-132">Provide connection string</span></span>

``` console
Migrate.exe BlogDemo.dll /connectionString=”Data Source=localhost;Initial Catalog=BlogDemo;Integrated Security=SSPI” /connectionProviderName=”System.Data.SqlClient”
```

<span data-ttu-id="0d267-133">Si desea especificar una cadena de conexión en la línea de comandos también debe proporcionar el nombre del proveedor.</span><span class="sxs-lookup"><span data-stu-id="0d267-133">If you wish to specify a connection string at the command line then you must also provide the provider name.</span></span> <span data-ttu-id="0d267-134">No se especifica el nombre del proveedor se producirá una excepción.</span><span class="sxs-lookup"><span data-stu-id="0d267-134">Not specifying the provider name will cause an exception.</span></span>

## <a name="common-problems"></a><span data-ttu-id="0d267-135">Problemas habituales</span><span class="sxs-lookup"><span data-stu-id="0d267-135">Common Problems</span></span>

| <span data-ttu-id="0d267-136">Mensaje de error</span><span class="sxs-lookup"><span data-stu-id="0d267-136">Error Message</span></span>                                                                                                                                                                                                                                                                                                                      | <span data-ttu-id="0d267-137">Soluciones</span><span class="sxs-lookup"><span data-stu-id="0d267-137">Solution</span></span>                                                                                                                                                                                                                                                                                             |
|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0d267-138">Excepción no controlada: System.IO.FileLoadException: no se pudo cargar el archivo o ensamblado ' Entity Framework, versión = 5.0.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089' o uno de sus dependencias.</span><span class="sxs-lookup"><span data-stu-id="0d267-138">Unhandled Exception: System.IO.FileLoadException:  Could not load file or assembly 'EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="0d267-139">Definición del manifiesto de ensamblado encontrada no coincide con la referencia de ensamblado.</span><span class="sxs-lookup"><span data-stu-id="0d267-139">The located assembly's manifest definition does not match the assembly reference.</span></span> <span data-ttu-id="0d267-140">(Excepción de HRESULT: 0x80131040)</span><span class="sxs-lookup"><span data-stu-id="0d267-140">(Exception from HRESULT: 0x80131040)</span></span>         | <span data-ttu-id="0d267-141">Normalmente, esto significa que se está ejecutando una aplicación de .NET 4 sin el archivo Redirect.config.</span><span class="sxs-lookup"><span data-stu-id="0d267-141">This typically means that you are running a .NET 4 application without the Redirect.config file.</span></span> <span data-ttu-id="0d267-142">Deberá copiar el Redirect.config en la misma ubicación que migrate.exe y cámbielo por migrate.exe.config.</span><span class="sxs-lookup"><span data-stu-id="0d267-142">You need to copy the Redirect.config to the same location as migrate.exe and rename it to migrate.exe.config.</span></span>                                                                                       |
| <span data-ttu-id="0d267-143">Excepción no controlada: System.IO.FileLoadException: no se pudo cargar el archivo o ensamblado ' Entity Framework, versión = 4.4.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089' o uno de sus dependencias.</span><span class="sxs-lookup"><span data-stu-id="0d267-143">Unhandled Exception: System.IO.FileLoadException: Could not load file or assembly 'EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="0d267-144">Definición del manifiesto de ensamblado encontrada no coincide con la referencia de ensamblado.</span><span class="sxs-lookup"><span data-stu-id="0d267-144">The located assembly's manifest definition does not match the assembly reference.</span></span> <span data-ttu-id="0d267-145">(Excepción de HRESULT: 0x80131040)</span><span class="sxs-lookup"><span data-stu-id="0d267-145">(Exception from HRESULT: 0x80131040)</span></span>          | <span data-ttu-id="0d267-146">Esta excepción significa que se está ejecutando una aplicación con el Redirect.config se copia en la ubicación de migrate.exe de .NET 4.5.</span><span class="sxs-lookup"><span data-stu-id="0d267-146">This exception means that you are running a .NET 4.5 application with the Redirect.config copied to the migrate.exe location.</span></span> <span data-ttu-id="0d267-147">Si su aplicación es .NET 4.5 no es necesario tener el archivo de configuración con las redirecciones dentro.</span><span class="sxs-lookup"><span data-stu-id="0d267-147">If your app is .NET 4.5 then you do not need to have the config file with the redirects inside.</span></span> <span data-ttu-id="0d267-148">Elimine el archivo migrate.exe.config.</span><span class="sxs-lookup"><span data-stu-id="0d267-148">Delete the migrate.exe.config file.</span></span>                                    |
| <span data-ttu-id="0d267-149">ERROR: No se puede actualizar la base de datos para que coincida con el modelo actual porque hay cambios pendientes y migración automática está deshabilitada.</span><span class="sxs-lookup"><span data-stu-id="0d267-149">ERROR: Unable to update database to match the current model because there are pending changes and automatic migration is disabled.</span></span> <span data-ttu-id="0d267-150">Escribir los cambios pendientes del modelo a una migración basada en código o habilitar la migración automática.</span><span class="sxs-lookup"><span data-stu-id="0d267-150">Either write the pending model changes to a code-based migration or enable automatic migration.</span></span> <span data-ttu-id="0d267-151">Establecer DbMigrationsConfiguration.AutomaticMigrationsEnabled en True para habilitar la migración automática.</span><span class="sxs-lookup"><span data-stu-id="0d267-151">Set DbMigrationsConfiguration.AutomaticMigrationsEnabled to true to enable automatic migration.</span></span> | <span data-ttu-id="0d267-152">Este error se produce si la migración cuando no ha creado una migración para hacer frente a los cambios realizados en el modelo y la base de datos no coincide con el modelo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="0d267-152">This error occurs if running migrate when you haven’t created a migration to cope with changes made to the model, and the database does not match the model.</span></span> <span data-ttu-id="0d267-153">Agregar una propiedad a una clase de modelo, a continuación, ejecuta migrate.exe sin necesidad de crear una migración para actualizar la base de datos es un ejemplo de esto.</span><span class="sxs-lookup"><span data-stu-id="0d267-153">Adding a property to a model class then running migrate.exe without creating a migration to upgrade the database is an example of this.</span></span> |
| <span data-ttu-id="0d267-154">ERROR: No se resuelve el tipo de miembro ' System.Data.Entity.Migrations.Design.ToolingFacade+UpdateRunner,EntityFramework, Version = 5.0.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089'.</span><span class="sxs-lookup"><span data-stu-id="0d267-154">ERROR: Type is not resolved for member 'System.Data.Entity.Migrations.Design.ToolingFacade+UpdateRunner,EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.</span></span>                                                                                                                                       | <span data-ttu-id="0d267-155">Este error puede deberse al especificar un directorio de inicio incorrecta.</span><span class="sxs-lookup"><span data-stu-id="0d267-155">This error can be caused by specifying an incorrect startup directory.</span></span> <span data-ttu-id="0d267-156">Debe tratarse de la ubicación de migrate.exe</span><span class="sxs-lookup"><span data-stu-id="0d267-156">This must be the location of migrate.exe</span></span>                                                                                                                                                                                      |
| <span data-ttu-id="0d267-157">Excepción no controlada: System.NullReferenceException: referencia a objeto no establecida para una instancia de un objeto.</span><span class="sxs-lookup"><span data-stu-id="0d267-157">Unhandled Exception: System.NullReferenceException: Object reference not set to an instance of an object.</span></span> <br/>   <span data-ttu-id="0d267-158">en System.Data.Entity.Migrations.Console.Program.Main (String [] args)</span><span class="sxs-lookup"><span data-stu-id="0d267-158">at System.Data.Entity.Migrations.Console.Program.Main(String[] args)</span></span>                                                                                                                                             | <span data-ttu-id="0d267-159">Esto puede deberse al no especificar un parámetro necesario para un escenario que esté utilizando.</span><span class="sxs-lookup"><span data-stu-id="0d267-159">This can be caused by not specifying a required parameter for a scenario that you are using.</span></span> <span data-ttu-id="0d267-160">Por ejemplo si se especifica una cadena de conexión sin especificar el nombre del proveedor.</span><span class="sxs-lookup"><span data-stu-id="0d267-160">For example specifying a connection string without specifying the provider name.</span></span>                                                                                                                        |
| <span data-ttu-id="0d267-161">ERROR: se encontró más de un tipo de configuración de las migraciones en el ensamblado 'ClassLibrary1'.</span><span class="sxs-lookup"><span data-stu-id="0d267-161">ERROR: More than one migrations configuration type was found in the assembly 'ClassLibrary1'.</span></span> <span data-ttu-id="0d267-162">Especifique el nombre de usar uno.</span><span class="sxs-lookup"><span data-stu-id="0d267-162">Specify the name of the one to use.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="0d267-163">Como indica el error, hay más de una clase de configuración en el ensamblado especificado.</span><span class="sxs-lookup"><span data-stu-id="0d267-163">As the error states, there is more than one configuration class in the given assembly.</span></span> <span data-ttu-id="0d267-164">Debe usar el modificador /configurationType para especificar que se va a usar.</span><span class="sxs-lookup"><span data-stu-id="0d267-164">You must use the /configurationType switch to specify which to use.</span></span>                                                                                                                                           |
| <span data-ttu-id="0d267-165">ERROR: No se pudo cargar archivo o ensamblado '&lt;assemblyName&gt;' o uno de sus dependencias.</span><span class="sxs-lookup"><span data-stu-id="0d267-165">ERROR: Could not load file or assembly ‘&lt;assemblyName&gt;’ or one of its dependencies.</span></span> <span data-ttu-id="0d267-166">El ensamblado dado el nombre o código base no era válido.</span><span class="sxs-lookup"><span data-stu-id="0d267-166">The given assembly name or codebase was invalid.</span></span> <span data-ttu-id="0d267-167">(Excepción de HRESULT: 0x80131047)</span><span class="sxs-lookup"><span data-stu-id="0d267-167">(Exception from HRESULT: 0x80131047)</span></span>                                                                                                                                                    | <span data-ttu-id="0d267-168">Esto puede deberse a especificar un nombre de ensamblado incorrecto o no tener</span><span class="sxs-lookup"><span data-stu-id="0d267-168">This can be caused by specifying an assembly name incorrectly or not having</span></span>                                                                                                                                                                                                                          |
| <span data-ttu-id="0d267-169">ERROR: No se pudo cargar archivo o ensamblado '&lt;assemblyName&gt;' o uno de sus dependencias.</span><span class="sxs-lookup"><span data-stu-id="0d267-169">ERROR: Could not load file or assembly ‘&lt;assemblyName&gt;' or one of its dependencies.</span></span> <span data-ttu-id="0d267-170">Se ha intentado cargar un programa con un formato incorrecto.</span><span class="sxs-lookup"><span data-stu-id="0d267-170">An attempt was made to load a program with an incorrect format.</span></span>                                                                                                                                                                          | <span data-ttu-id="0d267-171">Esto ocurre si intenta ejecutar migrate.exe contra un x64 aplicación.</span><span class="sxs-lookup"><span data-stu-id="0d267-171">This happens if you are trying to run migrate.exe against an x64 application.</span></span> <span data-ttu-id="0d267-172">EF 5.0 y, a continuación solo funcionará en x86.</span><span class="sxs-lookup"><span data-stu-id="0d267-172">EF 5.0 and below will only work on x86.</span></span>                                                                                                                                                                                |
