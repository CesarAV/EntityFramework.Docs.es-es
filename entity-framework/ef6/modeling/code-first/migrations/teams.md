---
title: Migraciones de Code First en entornos de equipo - EF6
author: divega
ms.date: 10/23/2016
ms.assetid: 4c2d9a95-de6f-4e97-9738-c1f8043eff69
ms.openlocfilehash: f5216a80928625040d6719f0e97ae786e5e33e05
ms.sourcegitcommit: 2b787009fd5be5627f1189ee396e708cd130e07b
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/13/2018
ms.locfileid: "45490511"
---
# <a name="code-first-migrations-in-team-environments"></a><span data-ttu-id="6ca7b-102">Migraciones de Code First en entornos de equipo</span><span class="sxs-lookup"><span data-stu-id="6ca7b-102">Code First Migrations in Team Environments</span></span>
> [!NOTE]
> <span data-ttu-id="6ca7b-103">En este artículo se supone que sabe cómo usar migraciones de Code First en escenarios básicos.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-103">This article assumes you know how to use Code First Migrations in basic scenarios.</span></span> <span data-ttu-id="6ca7b-104">Si no lo hace, necesitará leer [migraciones de Code First](~/ef6/modeling/code-first/migrations/index.md) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-104">If you don’t, then you’ll need to read [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) before continuing.</span></span>

## <a name="grab-a-coffee-you-need-to-read-this-whole-article"></a><span data-ttu-id="6ca7b-105">Tómese un café, debe leer todo el artículo</span><span class="sxs-lookup"><span data-stu-id="6ca7b-105">Grab a coffee, you need to read this whole article</span></span>

<span data-ttu-id="6ca7b-106">Los problemas en entornos de equipo son principalmente en torno a combinar las migraciones cuando dos programadores han generado las migraciones en su base de código local.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-106">The issues in team environments are mostly around merging migrations when two developers have generated migrations in their local code base.</span></span> <span data-ttu-id="6ca7b-107">Aunque los pasos para solucionar este son bastante simples, requieren que tenga un conocimiento sólido de funcionamiento de las migraciones.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-107">While the steps to solve these are pretty simple, they require you to have a solid understanding of how migrations works.</span></span> <span data-ttu-id="6ca7b-108">Por favor, simplemente se no ir directamente al final: dedicar tiempo a leer el artículo completo para asegurarse de que es correctas.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-108">Please don’t just skip ahead to the end – take the time to read the whole article to ensure you are successful.</span></span>

## <a name="some-general-guidelines"></a><span data-ttu-id="6ca7b-109">Algunas instrucciones generales</span><span class="sxs-lookup"><span data-stu-id="6ca7b-109">Some general guidelines</span></span>

<span data-ttu-id="6ca7b-110">Antes de profundizar en cómo administrar las migraciones de combinación generadas por varios desarrolladores, estas son algunas directrices generales para el éxito.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-110">Before we dig into how to manage merging migrations generated by multiple developers, here are some general guidelines to set you up for success.</span></span>

### <a name="each-team-member-should-have-a-local-development-database"></a><span data-ttu-id="6ca7b-111">Cada miembro del equipo debe tener una base de datos de desarrollo local</span><span class="sxs-lookup"><span data-stu-id="6ca7b-111">Each team member should have a local development database</span></span>

<span data-ttu-id="6ca7b-112">Las migraciones usa el  **\_ \_MigrationsHistory** tabla para almacenar qué migraciones se aplicaron a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-112">Migrations uses the **\_\_MigrationsHistory** table to store what migrations have been applied to the database.</span></span> <span data-ttu-id="6ca7b-113">Si tiene varios desarrolladores generar migraciones diferentes al intentar establecer como destino la misma base de datos (y, por tanto, comparten un  **\_ \_MigrationsHistory** tabla) las migraciones se va a obtener muy confundida.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-113">If you have multiple developers generating different migrations while trying to target the same database (and thus share a **\_\_MigrationsHistory** table) migrations is going to get very confused.</span></span>

<span data-ttu-id="6ca7b-114">Por supuesto, si tiene los miembros del equipo que no están generando las migraciones, no hay ningún problema en la necesidad de compartir una base de datos central de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-114">Of course, if you have team members that aren’t generating migrations, there is no problem having them share a central development database.</span></span>

### <a name="avoid-automatic-migrations"></a><span data-ttu-id="6ca7b-115">Evitar las migraciones automáticas</span><span class="sxs-lookup"><span data-stu-id="6ca7b-115">Avoid automatic migrations</span></span>

<span data-ttu-id="6ca7b-116">La conclusión es que las migraciones automáticas inicialmente se muestren correctamente en entornos de equipo, pero en realidad simplemente no funcionan.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-116">The bottom line is that automatic migrations initially look good in team environments, but in reality they just don’t work.</span></span> <span data-ttu-id="6ca7b-117">Si desea saber por qué, siga leyendo: si no es así, a continuación, puede ir a la sección siguiente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-117">If you want to know why, keep reading – if not, then you can skip to the next section.</span></span>

<span data-ttu-id="6ca7b-118">Las migraciones automáticas le permite tener el esquema de base de datos actualizado para que coincida con el modelo actual sin necesidad de generar archivos de código (migraciones basadas en código).</span><span class="sxs-lookup"><span data-stu-id="6ca7b-118">Automatic migrations allows you to have your database schema updated to match the current model without the need to generate code files (code-based migrations).</span></span> <span data-ttu-id="6ca7b-119">Las migraciones automáticas podría funcionar muy bien en un entorno de equipo si había usado jamás solo y nunca genera las migraciones basadas en código.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-119">Automatic migrations would work very well in a team environment if you only ever used them and never generated any code-based migrations.</span></span> <span data-ttu-id="6ca7b-120">El problema es que las migraciones automáticas están limitadas y no controlan un número de operaciones, propiedad o columna cambia el nombre, mover datos a otra tabla, etcetera. Para administrar estos escenarios terminará generando las migraciones basadas en código (y el código con scaffolding de edición) que se mezclan entre los cambios que se controlan mediante las migraciones automáticas.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-120">The problem is that automatic migrations are limited and don’t handle a number of operations – property/column renames, moving data to another table, etc. To handle these scenarios you end up generating code-based migrations (and editing the scaffolded code) that are mixed in between changes that are handled by automatic migrations.</span></span> <span data-ttu-id="6ca7b-121">Esto hace casi en imposible para combinar los cambios cuando dos de los desarrolladores protegen las migraciones.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-121">This makes it near on impossible to merge changes when two developers check in migrations.</span></span>

## <a name="screencasts"></a><span data-ttu-id="6ca7b-122">Presentaciones en pantalla</span><span class="sxs-lookup"><span data-stu-id="6ca7b-122">Screencasts</span></span>

<span data-ttu-id="6ca7b-123">Si en su lugar, podría ver una presentación en pantalla que lea este artículo, los siguientes dos vídeos abarcan el mismo contenido que este artículo.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-123">If you'd rather watch a screencast than read this article, the following two videos cover the same content as this article.</span></span>

### <a name="video-one-migrations---under-the-hood"></a><span data-ttu-id="6ca7b-124">Otra de vídeo: "Migraciones: aspectos técnicos"</span><span class="sxs-lookup"><span data-stu-id="6ca7b-124">Video One: "Migrations - Under the Hood"</span></span>

<span data-ttu-id="6ca7b-125">[Esta presentación en pantalla](http://channel9.msdn.com/blogs/ef/migrations-under-the-hood) cubre cómo realiza un seguimiento de las migraciones y usa información sobre el modelo para detectar cambios en el modelo.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-125">[This screencast](http://channel9.msdn.com/blogs/ef/migrations-under-the-hood) covers how migrations tracks and uses information about the model to detect model changes.</span></span>

### <a name="video-two-migrations---team-environments"></a><span data-ttu-id="6ca7b-126">Dos de vídeo: "Migraciones: entornos de equipo"</span><span class="sxs-lookup"><span data-stu-id="6ca7b-126">Video Two: "Migrations - Team Environments"</span></span>

<span data-ttu-id="6ca7b-127">Creación de los conceptos descritos en el vídeo anterior, [esta presentación en pantalla](http://channel9.msdn.com/blogs/ef/migrations-team-environments) se tratan los problemas que surgen en un entorno de equipo y cómo solucionarlos.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-127">Building on the concepts from the previous video, [this screencast](http://channel9.msdn.com/blogs/ef/migrations-team-environments) covers the issues that arise in a team environment and how to solve them.</span></span>

## <a name="understanding-how-migrations-works"></a><span data-ttu-id="6ca7b-128">Comprender el funcionamiento de las migraciones</span><span class="sxs-lookup"><span data-stu-id="6ca7b-128">Understanding how migrations works</span></span>

<span data-ttu-id="6ca7b-129">La clave para usar correctamente las migraciones en un entorno de equipo básico comprender cómo realiza un seguimiento de las migraciones y usa información sobre el modelo para detectar cambios en el modelo.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-129">The key to successfully using migrations in a team environment is a basic understanding how migrations tracks and uses information about the model to detect model changes.</span></span>

### <a name="the-first-migration"></a><span data-ttu-id="6ca7b-130">La primera migración</span><span class="sxs-lookup"><span data-stu-id="6ca7b-130">The first migration</span></span>

<span data-ttu-id="6ca7b-131">Cuando se agrega la primera migración al proyecto, ejecute algo parecido a **Add-Migration primer** en la consola de administrador de paquetes.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-131">When you add the first migration to your project, you run something like **Add-Migration First** in Package Manager Console.</span></span> <span data-ttu-id="6ca7b-132">A continuación, se ilustran los pasos de alto niveles que realiza este comando.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-132">The high level steps that this command performs are pictured below.</span></span>

![Primera migración](~/ef6/media/firstmigration.png)

<span data-ttu-id="6ca7b-134">El modelo actual se calcula desde el código (1).</span><span class="sxs-lookup"><span data-stu-id="6ca7b-134">The current model is calculated from your code (1).</span></span> <span data-ttu-id="6ca7b-135">Los objetos de base de datos necesarios, a continuación, se calculan las diferencias de modelo (2): puesto que es la primera migración del modelo difieren solo usa un modelo vacío para la comparación.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-135">The required database objects are then calculated by the model differ (2) – since this is the first migration the model differ just uses an empty model for the comparison.</span></span> <span data-ttu-id="6ca7b-136">Los cambios necesarios se pasan al generador de código para compilar el código de migración necesaria (3) que, a continuación, se agrega a la solución de Visual Studio (4).</span><span class="sxs-lookup"><span data-stu-id="6ca7b-136">The required changes are passed to the code generator to build the required migration code (3) which is then added to your Visual Studio solution (4).</span></span>

<span data-ttu-id="6ca7b-137">Además del código de migración real que se almacena en el archivo de código principal, las migraciones también genera algunos archivos adicionales de código subyacente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-137">In addition to the actual migration code that is stored in the main code file, migrations also generates some additional code-behind files.</span></span> <span data-ttu-id="6ca7b-138">Estos archivos son metadatos que se usan por migraciones y no son algo que debe editar.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-138">These files are metadata that is used by migrations and are not something you should edit.</span></span> <span data-ttu-id="6ca7b-139">Uno de estos archivos es un archivo de recursos (.resx) que contiene una instantánea del modelo en el momento en que se generó la migración.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-139">One of these files is a resource file (.resx) that contains a snapshot of the model at the time the migration was generated.</span></span> <span data-ttu-id="6ca7b-140">Verá cómo se utiliza en el paso siguiente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-140">You’ll see how this is used in the next step.</span></span>

<span data-ttu-id="6ca7b-141">En este momento probablemente se ejecutaría **Update-Database** para aplicar los cambios a la base de datos y, a continuación, vaya sobre la implementación de otras áreas de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-141">At this point you would probably run **Update-Database** to apply your changes to the database, and then go about implementing other areas of your application.</span></span>

### <a name="subsequent-migrations"></a><span data-ttu-id="6ca7b-142">Migraciones posteriores</span><span class="sxs-lookup"><span data-stu-id="6ca7b-142">Subsequent migrations</span></span>

<span data-ttu-id="6ca7b-143">Más adelante, vuelva y realizar algunos cambios en el modelo: en nuestro ejemplo vamos a agregar un **Url** propiedad **Blog**.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-143">Later you come back and make some changes to your model – in our example we’ll add a **Url** property to **Blog**.</span></span> <span data-ttu-id="6ca7b-144">A continuación, podría emitir un comando como **Add-Migration AddUrl** para aplicar scaffolding a una migración para la base de datos correspondiente de aplicar los cambios.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-144">You would then issue a command such as **Add-Migration AddUrl** to scaffold a migration to apply the corresponding database changes.</span></span> <span data-ttu-id="6ca7b-145">A continuación, se ilustran los pasos de alto niveles que realiza este comando.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-145">The high level steps that this command performs are pictured below.</span></span>

![Segunda migración](~/ef6/media/secondmigration.png)

<span data-ttu-id="6ca7b-147">Igual que la última vez, el modelo actual se calcula a partir de código (1).</span><span class="sxs-lookup"><span data-stu-id="6ca7b-147">Just like last time, the current model is calculated from code (1).</span></span> <span data-ttu-id="6ca7b-148">Sin embargo, esta vez hay las migraciones existentes para que el modelo anterior se recupera de la migración más reciente (2).</span><span class="sxs-lookup"><span data-stu-id="6ca7b-148">However, this time there are existing migrations so the previous model is retrieved from the latest migration (2).</span></span> <span data-ttu-id="6ca7b-149">Estos dos modelos son comparar para buscar los cambios de la base de datos necesarios (3) y, a continuación, finalice el proceso como antes.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-149">These two models are diffed to find the required database changes (3) and then the process completes as before.</span></span>

<span data-ttu-id="6ca7b-150">Este mismo proceso se usa para las migraciones adicionales que agregue al proyecto.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-150">This same process is used for any further migrations that you add to the project.</span></span>

### <a name="why-bother-with-the-model-snapshot"></a><span data-ttu-id="6ca7b-151">¿Por qué molestarse con la instantánea del modelo?</span><span class="sxs-lookup"><span data-stu-id="6ca7b-151">Why bother with the model snapshot?</span></span>

<span data-ttu-id="6ca7b-152">Quizás se pregunte por qué EF molesta con la instantánea del modelo: ¿por qué no solo vistazo a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-152">You may be wondering why EF bothers with the model snapshot – why not just look at the database.</span></span> <span data-ttu-id="6ca7b-153">Si es así, siga leyendo.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-153">If so, read on.</span></span> <span data-ttu-id="6ca7b-154">Si no le interesa, a continuación, puede omitir esta sección.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-154">If you’re not interested then you can skip this section.</span></span>

<span data-ttu-id="6ca7b-155">Hay una serie de motivos que EF mantiene alrededor de la instantánea del modelo:</span><span class="sxs-lookup"><span data-stu-id="6ca7b-155">There are a number of reasons EF keeps the model snapshot around:</span></span>

-   <span data-ttu-id="6ca7b-156">Permite a desviarse del modelo EF de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-156">It allows your database to drift from the EF model.</span></span> <span data-ttu-id="6ca7b-157">Estos cambios pueden realizarse directamente en la base de datos, o puede cambiar el código con scaffolding en las migraciones para realizar los cambios.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-157">These changes can be made directly in the database, or you can change the scaffolded code in your migrations to make the changes.</span></span> <span data-ttu-id="6ca7b-158">Estos son algunos ejemplos de esto en la práctica:</span><span class="sxs-lookup"><span data-stu-id="6ca7b-158">Here are a couple of examples of this in practice:</span></span>
    -   <span data-ttu-id="6ca7b-159">Desea agregar un insertadas y actualizadas para la columna a una o varias de las tablas pero no desea incluir estas columnas en el modelo de EF.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-159">You want to add an Inserted and Updated to column to one or more of your tables but you don’t want to include these columns in the EF model.</span></span> <span data-ttu-id="6ca7b-160">Si las migraciones examinado la base de datos intentaría continuamente quitar estas columnas, cada vez que se ha aplicado scaffolding a una migración.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-160">If migrations looked at the database it would continually try to drop these columns every time you scaffolded a migration.</span></span> <span data-ttu-id="6ca7b-161">Con la instantánea del modelo, EF detectará solo los cambios al modelo de confianza.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-161">Using the model snapshot, EF will only ever detect legitimate changes to the model.</span></span>
    -   <span data-ttu-id="6ca7b-162">Desea cambiar el cuerpo de un procedimiento almacenado usado para las actualizaciones debe para incluir algún registro.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-162">You want to change the body of a stored procedure used for updates to include some logging.</span></span> <span data-ttu-id="6ca7b-163">Si las migraciones mirado este procedimiento almacenado desde la base de datos podría pruebe y restablecer la definición que EF espera continuamente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-163">If migrations looked at this stored procedure from the database it would continually try and reset it back to the definition that EF expects.</span></span> <span data-ttu-id="6ca7b-164">Mediante el uso de la instantánea del modelo, EF aplicará solo la técnica scaffolding código para modificar el procedimiento almacenado cuando se cambia la forma del procedimiento en el modelo de EF.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-164">By using the model snapshot, EF will only ever scaffold code to alter the stored procedure when you change the shape of the procedure in the EF model.</span></span>
    -   <span data-ttu-id="6ca7b-165">Estos mismos principios se aplican a la adición de índices adicionales, incluidas tablas adicionales en la base de datos, asignación de EF a una vista de base de datos que se encuentra a través de una tabla, etcetera.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-165">These same principles apply to adding extra indexes, including extra tables in your database, mapping EF to a database view that sits over a table, etc.</span></span>
-   <span data-ttu-id="6ca7b-166">El modelo de EF contiene algo más que la forma de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-166">The EF model contains more than just the shape of the database.</span></span> <span data-ttu-id="6ca7b-167">Tener todo el modelo permite que las migraciones ver información acerca de las propiedades y clases en el modelo y cómo se asignan a las columnas y tablas.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-167">Having the entire model allows migrations to look at information about the properties and classes in your model and how they map to the columns and tables.</span></span> <span data-ttu-id="6ca7b-168">Esta información permite las migraciones a ser más inteligente en el código que aplica la técnica scaffolding.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-168">This information allows migrations to be more intelligent in the code that it scaffolds.</span></span> <span data-ttu-id="6ca7b-169">Por ejemplo, si cambia el nombre de la columna que se asigna una propiedad para las migraciones puede detectar el cambio de nombre por ver que es la misma propiedad: algo que no se puede realizar si solo tiene el esquema de base de datos.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-169">For example, if you change the name of the column that a property maps to migrations can detect the rename by seeing that it’s the same property – something that can’t be done if you only have the database schema.</span></span> 

## <a name="what-causes-issues-in-team-environments"></a><span data-ttu-id="6ca7b-170">¿Qué provoca problemas en entornos de equipo</span><span class="sxs-lookup"><span data-stu-id="6ca7b-170">What causes issues in team environments</span></span>

<span data-ttu-id="6ca7b-171">El flujo de trabajo se trata en la anterior funciona muy bien de sección cuando haya un único desarrollador que trabaja en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-171">The workflow covered in the previous section works great when you are a single developer working on an application.</span></span> <span data-ttu-id="6ca7b-172">También funciona bien en un entorno de equipo si es la única persona que realizar cambios en el modelo.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-172">It also works well in a team environment if you are the only person making changes to the model.</span></span> <span data-ttu-id="6ca7b-173">En este escenario puede realizar cambios en el modelo, genere las migraciones y enviarlas a su control de código fuente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-173">In this scenario you can make model changes, generate migrations and submit them to your source control.</span></span> <span data-ttu-id="6ca7b-174">Pueden sincronizar los cambios y ejecutar otros desarrolladores **Update-Database** que aplicar los cambios de esquema.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-174">Other developers can sync your changes and run **Update-Database** to have the schema changes applied.</span></span>

<span data-ttu-id="6ca7b-175">Iniciar problemas surgen cuando tiene varios desarrolladores realizar cambios en el modelo de EF y enviándolos al control de código fuente al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-175">Issues start to arise when you have multiple developers making changes to the EF model and submitting to source control at the same time.</span></span> <span data-ttu-id="6ca7b-176">Carece de EF es una manera de primera clase para combinar las migraciones locales con las migraciones que otro programador ha sometido a control de código fuente desde la última sincronización.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-176">What EF lacks is a first class way to merge your local migrations with migrations that another developer has submitted to source control since you last synced.</span></span>

## <a name="an-example-of-a-merge-conflict"></a><span data-ttu-id="6ca7b-177">Un ejemplo de un conflicto de combinación</span><span class="sxs-lookup"><span data-stu-id="6ca7b-177">An example of a merge conflict</span></span>

<span data-ttu-id="6ca7b-178">Primero echemos un vistazo a un ejemplo concreto de este tipo de conflicto de fusión mediante combinación.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-178">First let’s look at a concrete example of such a merge conflict.</span></span> <span data-ttu-id="6ca7b-179">Seguiremos en el ejemplo que analizamos anteriormente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-179">We’ll continue on with the example we looked at earlier.</span></span> <span data-ttu-id="6ca7b-180">Como una partida punto vamos a suponer que los cambios de la sección anterior se han protegido por el desarrollador original.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-180">As a starting point let’s assume the changes from the previous section were checked in by the original developer.</span></span> <span data-ttu-id="6ca7b-181">Realizaremos un seguimiento de dos desarrolladores como hacen los cambios al código base.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-181">We’ll track two developers as they make changes to code base.</span></span>

<span data-ttu-id="6ca7b-182">Realizaremos un seguimiento el modelo de EF y las migraciones a través de una serie de cambios.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-182">We’ll track the EF model and the migrations thru a number of changes.</span></span> <span data-ttu-id="6ca7b-183">Para un punto de partida, a los desarrolladores han sincronizado con el repositorio de control de código fuente, como se muestra en el gráfico siguiente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-183">For a starting point, both developers have synced to the source control repository, as depicted in the following graphic.</span></span>

![Punto de partida](~/ef6/media/startingpoint.png)

<span data-ttu-id="6ca7b-185">Desarrollador \#1 y desarrollador \#2 ahora realiza algunos cambios en el modelo de EF en su local código base.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-185">Developer \#1 and developer \#2 now makes some changes to the EF model in their local code base.</span></span> <span data-ttu-id="6ca7b-186">Desarrollador \#1 agrega un **clasificación** propiedad **Blog** – y genera un **AddRating** migración para aplicar los cambios a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-186">Developer \#1 adds a **Rating** property to **Blog** – and generates an **AddRating** migration to apply the changes to the database.</span></span> <span data-ttu-id="6ca7b-187">Desarrollador \#2 agrega un **lectores** propiedad **Blog** – y genera el correspondiente **AddReaders** migración.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-187">Developer \#2 adds a **Readers** property to **Blog** – and generates the corresponding **AddReaders** migration.</span></span> <span data-ttu-id="6ca7b-188">A los desarrolladores ejecutan **Update-Database**, para aplicar los cambios a sus bases de datos locales y, a continuación, continuar desarrollando la aplicación.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-188">Both developers run **Update-Database**, to apply the changes to their local databases, and then continue developing the application.</span></span>

> [!NOTE]
> <span data-ttu-id="6ca7b-189">Las migraciones van precedidas de una marca de tiempo, por lo que nuestro gráfico que representa la migración AddReaders Developer \#2 viene después de la migración AddRating Developer \#1.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-189">Migrations are prefixed with a timestamp, so our graphic represents that the AddReaders migration from Developer \#2 comes after the AddRating migration from Developer \#1.</span></span> <span data-ttu-id="6ca7b-190">Si developer \#1 o \#2 no generó el facilita la primera migración ninguna diferencia con los problemas de trabajar en un equipo o en el proceso de combinación que veremos en la sección siguiente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-190">Whether developer \#1 or \#2 generated the migration first makes no difference to the issues of working in a team, or the process for merging them that we’ll look at in the next section.</span></span>

![Cambios locales](~/ef6/media/localchanges.png)

<span data-ttu-id="6ca7b-192">Es un día de suerte para desarrollador \#1 cuando se produzcan al enviar sus cambios en primer lugar.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-192">It’s a lucky day for Developer \#1 as they happen to submit their changes first.</span></span> <span data-ttu-id="6ca7b-193">Dado que ninguna otra persona ha protegido desde que sincroniza en su repositorio, solo pueden enviar sus cambios sin necesidad de realizar cualquier combinación.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-193">Because no one else has checked in since they synced their repository, they can just submit their changes without performing any merging.</span></span>

![Enviar](~/ef6/media/submit.png)

<span data-ttu-id="6ca7b-195">Ahora es el momento para desarrollador \#2 para enviar.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-195">Now it’s time for Developer \#2 to submit.</span></span> <span data-ttu-id="6ca7b-196">No son tan de suerte.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-196">They aren’t so lucky.</span></span> <span data-ttu-id="6ca7b-197">Dado que otra persona ha enviado cambios desde que sincronizan, necesitan deslice hacia abajo los cambios y la combinación.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-197">Because someone else has submitted changes since they synced, they will need to pull down the changes and merge.</span></span> <span data-ttu-id="6ca7b-198">El sistema de control de origen probablemente podrá combinar automáticamente los cambios en el nivel de código, ya que son muy simples.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-198">The source control system will likely be able to automatically merge the changes at the code level since they are very simple.</span></span> <span data-ttu-id="6ca7b-199">El estado de desarrollador \#local de 2 del repositorio después de la sincronización se muestra en el gráfico siguiente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-199">The state of Developer \#2’s local repository after syncing is depicted in the following graphic.</span></span> 

![Incorporación de cambios](~/ef6/media/pull.png)

<span data-ttu-id="6ca7b-201">En esta fase para desarrolladores \#puede ejecutar 2 **Update-Database** que detectará la nueva **AddRating** migración (que no se ha aplicado al desarrollador \#de 2 base de datos) y aplicarla.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-201">At this stage Developer \#2 can run **Update-Database** which will detect the new **AddRating** migration (which hasn’t been applied to Developer \#2’s database) and apply it.</span></span> <span data-ttu-id="6ca7b-202">Ahora el **clasificación** columna se agrega a la **Blogs** está sincronizada con el modelo de tabla y la base de datos.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-202">Now the **Rating** column is added to the **Blogs** table and the database is in sync with the model.</span></span>

<span data-ttu-id="6ca7b-203">Sin embargo, existen un par de problemas:</span><span class="sxs-lookup"><span data-stu-id="6ca7b-203">There are a couple of problems though:</span></span>

1.  <span data-ttu-id="6ca7b-204">Aunque **Update-Database** se aplicará la **AddRating** también generará una advertencia de migración: *no se puede actualizar la base de datos para que coincida con el modelo actual porque hay cambios pendientes y se deshabilitó la migración automática...*</span><span class="sxs-lookup"><span data-stu-id="6ca7b-204">Although **Update-Database** will apply the **AddRating** migration it will also raise a warning: *Unable to update database to match the current model because there are pending changes and automatic migration is disabled…*</span></span>
    <span data-ttu-id="6ca7b-205">El problema es que la instantánea del modelo se almacena en la última migración (**AddReader**) falta el **clasificación** propiedad **Blog** (puesto que no era parte del modelo cuando el se ha generado la migración).</span><span class="sxs-lookup"><span data-stu-id="6ca7b-205">The problem is that the model snapshot stored in the last migration (**AddReader**) is missing the **Rating** property on **Blog** (since it wasn’t part of the model when the migration was generated).</span></span> <span data-ttu-id="6ca7b-206">En primer lugar, el código detecta que el modelo en la última migración no coincide con el modelo actual y genera la advertencia.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-206">Code First detects that the model in the last migration doesn’t match the current model and raises the warning.</span></span>
2.  <span data-ttu-id="6ca7b-207">Ejecutar la aplicación daría como resultado una excepción InvalidOperationException que indica que "*el model que respalda el contexto 'BloggingContext' ha cambiado desde que se creó la base de datos. Considere la posibilidad de usar migraciones de Code First para actualizar la base de datos"*</span><span class="sxs-lookup"><span data-stu-id="6ca7b-207">Running the application would result in an InvalidOperationException stating that “*The model backing the 'BloggingContext' context has changed since the database was created. Consider using Code First Migrations to update the database…”*</span></span>
    <span data-ttu-id="6ca7b-208">Nuevamente, el problema es que la instantánea del modelo almacenada en la última migración no coincide con el modelo actual.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-208">Again, the problem is the model snapshot stored in the last migration doesn’t match the current model.</span></span>
3.  <span data-ttu-id="6ca7b-209">Por último, esperaríamos ejecución **Add-Migration** ahora generaría una migración vacía (ya que no hay ningún cambio para aplicar a la base de datos).</span><span class="sxs-lookup"><span data-stu-id="6ca7b-209">Finally, we would expect running **Add-Migration** now would generate an empty migration (since there are no changes to apply to the database).</span></span> <span data-ttu-id="6ca7b-210">Sin embargo, dado que las migraciones se compara el modelo actual a uno desde la última migración (que falta el **clasificación** propiedad) aplicará realmente la técnica scaffolding otro **AddColumn** llamada para agregar en el **Clasificación** columna.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-210">But because migrations compares the current model to the one from the last migration (which is missing the **Rating** property) it will actually scaffold another **AddColumn** call to add in the **Rating** column.</span></span> <span data-ttu-id="6ca7b-211">Por supuesto, esta migración produciría un error durante la **Update-Database** porque el **clasificación** columna ya existe.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-211">Of course, this migration would fail during **Update-Database** because the **Rating** column already exists.</span></span>

## <a name="resolving-the-merge-conflict"></a><span data-ttu-id="6ca7b-212">Resolver los conflictos de combinación</span><span class="sxs-lookup"><span data-stu-id="6ca7b-212">Resolving the merge conflict</span></span>

<span data-ttu-id="6ca7b-213">La buena noticia es que no es demasiado difícil de tratar con la combinación manualmente, siempre que tenga una comprensión del funcionamiento de las migraciones.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-213">The good news is that it’s not too hard to deal with the merge manually – provided you have an understanding of how migrations works.</span></span> <span data-ttu-id="6ca7b-214">Por tanto, si ha omitido con antelación a esta sección...</span><span class="sxs-lookup"><span data-stu-id="6ca7b-214">So if you’ve skipped ahead to this section…</span></span> <span data-ttu-id="6ca7b-215">lo sentimos, que deberá volver y leer primero el resto del artículo.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-215">sorry, you need to go back and read the rest of the article first!</span></span>

<span data-ttu-id="6ca7b-216">Hay dos opciones, es el más fácil generar una migración en blanco que contenga el modelo actual correcto como una instantánea.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-216">There are two options, the easiest is to generate a blank migration that has the correct current model as a snapshot.</span></span> <span data-ttu-id="6ca7b-217">La segunda opción consiste en actualizar la instantánea en la última migración que tiene el formato correcto instantánea del modelo.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-217">The second option is to update the snapshot in the last migration to have the correct model snapshot.</span></span> <span data-ttu-id="6ca7b-218">La segunda opción es un poco más difícil y no se puede usar en todos los escenarios, pero también es más limpio porque no implica agregar una migración adicional.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-218">The second option is a little harder and can’t be used in every scenario, but it’s also cleaner because it doesn’t involve adding an extra migration.</span></span>

### <a name="option-1-add-a-blank-merge-migration"></a><span data-ttu-id="6ca7b-219">Opción 1: Agregar una migración en blanco 'merge'</span><span class="sxs-lookup"><span data-stu-id="6ca7b-219">Option 1: Add a blank ‘merge’ migration</span></span>

<span data-ttu-id="6ca7b-220">En esta opción se genere una migración en blanco únicamente con el fin de asegurarse de que la migración más reciente tiene la instantánea del modelo correcto almacenados en ella.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-220">In this option we generate a blank migration solely for the purpose of making sure the latest migration has the correct model snapshot stored in it.</span></span>

<span data-ttu-id="6ca7b-221">Esta opción puede utilizarse con independencia de que generó la última migración.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-221">This option can be used regardless of who generated the last migration.</span></span> <span data-ttu-id="6ca7b-222">En el ejemplo que hemos estado siguiendo Developer \#2 se ocupa de la fusión mediante combinación y le ha ocurrido a generar la última migración.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-222">In the example we’ve been following Developer \#2 is taking care of the merge and they happened to generate the last migration.</span></span> <span data-ttu-id="6ca7b-223">Pero se pueden usar estos mismos pasos si desarrollador \#1 genera la última migración.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-223">But these same steps can be used if Developer \#1 generated the last migration.</span></span> <span data-ttu-id="6ca7b-224">Los pasos también se aplican si intervienen varias migraciones, simplemente hemos analizado dos para mantenerlo simple.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-224">The steps also apply if there are multiple migrations involved – we’ve just been looking at two in order to keep it simple.</span></span>

<span data-ttu-id="6ca7b-225">El proceso siguiente puede utilizarse para este enfoque, comenzando desde el momento en que se da cuenta de que los cambios que deben sincronizarse desde control de código fuente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-225">The following process can be used for this approach, starting from the time you realize you have changes that need to be synced from source control.</span></span>

1.  <span data-ttu-id="6ca7b-226">Asegúrese de que se han escrito los cambios pendientes del modelo en la base de código local para una migración.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-226">Ensure any pending model changes in your local code base have been written to a migration.</span></span> <span data-ttu-id="6ca7b-227">Este paso garantiza que no pierda los cambios legítimos cuando llegue el momento para generar la migración en blanco.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-227">This step ensures you don’t miss any legitimate changes when it comes time to generate the blank migration.</span></span>
2.  <span data-ttu-id="6ca7b-228">Sincronización con control de código fuente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-228">Sync with source control.</span></span>
3.  <span data-ttu-id="6ca7b-229">Ejecute **Update-Database** para aplicar cualquier migración nueva que se han protegido otros desarrolladores.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-229">Run **Update-Database** to apply any new migrations that other developers have checked in.</span></span>
    <span data-ttu-id="6ca7b-230">\*\*
    *Nota: \*\*\* si no obtiene las advertencias del comando Update-Database, a continuación, se han producido ninguna nueva migración de otros desarrolladores y no hay ninguna necesidad de realizar cualquier combinación.*</span><span class="sxs-lookup"><span data-stu-id="6ca7b-230">\*\*
*Note:\*\*\*\*if you don’t get any warnings from the Update-Database command then there were no new migrations from other developers and there is no need to perform any further merging.*</span></span>
4.  <span data-ttu-id="6ca7b-231">Ejecute **Add-Migration &lt;elegir\_un\_nombre&gt; – IgnoreChanges** (por ejemplo, **mezcla Add-Migration – IgnoreChanges**).</span><span class="sxs-lookup"><span data-stu-id="6ca7b-231">Run **Add-Migration &lt;pick\_a\_name&gt; –IgnoreChanges** (for example, **Add-Migration Merge –IgnoreChanges**).</span></span> <span data-ttu-id="6ca7b-232">Esto genera una migración con todos los metadatos (incluida una instantánea del modelo actual), pero se pasará por alto los cambios que se detecta al comparar los modelos actual a la instantánea en las últimas migraciones (lo que significa que obtendrá un espacio en blanco **seguridad** y **Abajo** método).</span><span class="sxs-lookup"><span data-stu-id="6ca7b-232">This generates a migration with all the metadata (including a snapshot of the current model) but will ignore any changes it detects when comparing the current model to the snapshot in the last migrations (meaning you get a blank **Up** and **Down** method).</span></span>
5.  <span data-ttu-id="6ca7b-233">Continuar desarrollando o enviar al control de código fuente (después de ejecutar sus pruebas unitarias por supuesto).</span><span class="sxs-lookup"><span data-stu-id="6ca7b-233">Continue developing, or submit to source control (after running your unit tests of course).</span></span>

<span data-ttu-id="6ca7b-234">Este es el estado de desarrollador \#local de 2 del código base después de usar este enfoque.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-234">Here is the state of Developer \#2’s local code base after using this approach.</span></span>

![Migración de mezcla](~/ef6/media/mergemigration.png)

### <a name="option-2-update-the-model-snapshot-in-the-last-migration"></a><span data-ttu-id="6ca7b-236">Opción 2: Actualizar la instantánea del modelo en la última migración</span><span class="sxs-lookup"><span data-stu-id="6ca7b-236">Option 2: Update the model snapshot in the last migration</span></span>

<span data-ttu-id="6ca7b-237">Esta opción es muy similar a la opción 1, pero evita la migración en blanco adicionales – porque Seamos realistas, que desea que los archivos de código adicional en su solución.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-237">This option is very similar to option 1 but removes the extra blank migration – because let’s face it, who wants extra code files in their solution.</span></span>

<span data-ttu-id="6ca7b-238">**Este enfoque sólo es posible si la migración más reciente solo existe en la base de código local y no todavía se envió al control de código fuente (por ejemplo, si la última migración generada por el usuario que realiza la combinación)**.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-238">**This approach is only feasible if the latest migration exists only in your local code base and has not yet been submitted to source control (for example, if the last migration was generated by the user doing the merge)**.</span></span> <span data-ttu-id="6ca7b-239">Editar los metadatos de las migraciones que otros desarrolladores haya aplicado a su base de datos de desarrollo, o incluso peor se aplica a una base de datos de producción, puede producir efectos laterales inesperados.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-239">Editing the metadata of migrations that other developers may have already applied to their development database – or even worse applied to a production database – can result in unexpected side effects.</span></span> <span data-ttu-id="6ca7b-240">Durante el proceso, vamos a revertir la última migración en nuestra base de datos local y volver a aplicarlo con los metadatos actualizados.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-240">During the process we’re going to roll back the last migration in our local database and re-apply it with updated metadata.</span></span>

<span data-ttu-id="6ca7b-241">Aunque la última migración necesita simplemente ser en el código local base no existen restricciones para el número o el orden de las migraciones que lo continuar.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-241">While the last migration needs to just be in the local code base there are no restrictions to the number or order of migrations that proceed it.</span></span> <span data-ttu-id="6ca7b-242">Puede haber varias migraciones de varios desarrolladores diferentes y se aplican los mismos pasos, simplemente hemos analizado dos para mantenerlo simple.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-242">There can be multiple migrations from multiple different developers and the same steps apply– we’ve just been looking at two in order to keep it simple.</span></span>

<span data-ttu-id="6ca7b-243">El proceso siguiente puede utilizarse para este enfoque, comenzando desde el momento en que se da cuenta de que los cambios que deben sincronizarse desde control de código fuente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-243">The following process can be used for this approach, starting from the time you realize you have changes that need to be synced from source control.</span></span>

1.  <span data-ttu-id="6ca7b-244">Asegúrese de que se han escrito los cambios pendientes del modelo en la base de código local para una migración.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-244">Ensure any pending model changes in your local code base have been written to a migration.</span></span> <span data-ttu-id="6ca7b-245">Este paso garantiza que no pierda los cambios legítimos cuando llegue el momento para generar la migración en blanco.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-245">This step ensures you don’t miss any legitimate changes when it comes time to generate the blank migration.</span></span>
2.  <span data-ttu-id="6ca7b-246">Sincronizar con el control de código fuente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-246">Sync with the source control.</span></span>
3.  <span data-ttu-id="6ca7b-247">Ejecute **Update-Database** para aplicar cualquier migración nueva que se han protegido otros desarrolladores.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-247">Run **Update-Database** to apply any new migrations that other developers have checked in.</span></span>
    <span data-ttu-id="6ca7b-248">\*\*
    *Nota: \*\*\* si no obtiene las advertencias del comando Update-Database, a continuación, se han producido ninguna nueva migración de otros desarrolladores y no hay ninguna necesidad de realizar cualquier combinación.*</span><span class="sxs-lookup"><span data-stu-id="6ca7b-248">\*\*
*Note:\*\*\*\*if you don’t get any warnings from the Update-Database command then there were no new migrations from other developers and there is no need to perform any further merging.*</span></span>
4.  <span data-ttu-id="6ca7b-249">Ejecute **Update-Database: TargetMigration &lt;segundo\_última\_migración&gt;**  (en el ejemplo que hemos estado siguiendo sería **Update-Database: TargetMigration AddRating**).</span><span class="sxs-lookup"><span data-stu-id="6ca7b-249">Run **Update-Database –TargetMigration &lt;second\_last\_migration&gt;** (in the example we’ve been following this would be **Update-Database –TargetMigration AddRating**).</span></span> <span data-ttu-id="6ca7b-250">Este roles hacer una copia de la base de datos al estado de la segunda última migración – eficazmente 'sin aplicar' la última migración desde la base de datos.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-250">This roles the database back to the state of the second last migration – effectively ‘un-applying’ the last migration from the database.</span></span>
    <span data-ttu-id="6ca7b-251">\*\*
    *Nota: \*\*\* este paso es necesario para que sea seguro editar los metadatos de la migración, ya que los metadatos también se almacenan en el \_ \_MigrationsHistoryTable de la base de datos. Se trata de por qué sólo se debe utilizar esta opción si la última migración únicamente está en la base de código local. Si otras bases de datos tenían la última migración aplicada también tendría que ellos revertir y volver a aplicar la última migración para actualizar los metadatos.*</span><span class="sxs-lookup"><span data-stu-id="6ca7b-251">\*\*
*Note:\*\*\*\*This step is required to make it safe to edit the metadata of the migration since the metadata is also stored in the \_\_MigrationsHistoryTable of the database. This is why you should only use this option if the last migration is only in your local code base. If other databases had the last migration applied you would also have to roll them back and re-apply the last migration to update the metadata.*</span></span> 
5.  <span data-ttu-id="6ca7b-252">Ejecute **Add-Migration &lt;completa\_nombre\_incluidos\_timestamp\_de\_última\_migración** &gt; (en el ejemplo nos hemos ido siguiendo sería algo parecido a **Add-Migration 201311062215252\_AddReaders**).</span><span class="sxs-lookup"><span data-stu-id="6ca7b-252">Run **Add-Migration &lt;full\_name\_including\_timestamp\_of\_last\_migration**&gt; (in the example we’ve been following this would be something like **Add-Migration 201311062215252\_AddReaders**).</span></span>
    <span data-ttu-id="6ca7b-253">\*\*
    *Nota: \*\*\* debe incluir la marca de tiempo para que sepa que las migraciones que desea editar la migración existente en lugar de scaffolding uno nuevo.*</span><span class="sxs-lookup"><span data-stu-id="6ca7b-253">\*\*
    *Note:\*\*\*\*You need to include the timestamp so that migrations knows you want to edit the existing migration rather than scaffolding a new one.*</span></span>
<span data-ttu-id="6ca7b-254">Esto actualizará los metadatos de la última migración para que coincida con el modelo actual.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-254">This will update the metadata for the last migration to match the current model.</span></span> <span data-ttu-id="6ca7b-255">Obtendrá la siguiente advertencia cuando se complete el comando, pero eso es exactamente lo que desea.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-255">You’ll get the following warning when the command completes, but that’s exactly what you want.</span></span> <span data-ttu-id="6ca7b-256">"*Sólo el código de diseñador para la migración ' 201311062215252\_'AddReaders se vuelve a con scaffolding. Para volver a aplicar la técnica scaffolding de la migración completa, utilice el parámetro - Force. "*</span><span class="sxs-lookup"><span data-stu-id="6ca7b-256">“*Only the Designer Code for migration '201311062215252\_AddReaders' was re-scaffolded. To re-scaffold the entire migration, use the -Force parameter.”*</span></span>
6.  <span data-ttu-id="6ca7b-257">Ejecute **Update-Database** para volver a aplicar la migración más reciente con los metadatos actualizados.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-257">Run **Update-Database** to re-apply the latest migration with the updated metadata.</span></span>
7.  <span data-ttu-id="6ca7b-258">Continuar desarrollando o enviar al control de código fuente (después de ejecutar sus pruebas unitarias por supuesto).</span><span class="sxs-lookup"><span data-stu-id="6ca7b-258">Continue developing, or submit to source control (after running your unit tests of course).</span></span>

<span data-ttu-id="6ca7b-259">Este es el estado de desarrollador \#local de 2 del código base después de usar este enfoque.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-259">Here is the state of Developer \#2’s local code base after using this approach.</span></span>

![Metadatos actualizados](~/ef6/media/updatedmetadata.png)

## <a name="summary"></a><span data-ttu-id="6ca7b-261">Resumen</span><span class="sxs-lookup"><span data-stu-id="6ca7b-261">Summary</span></span>

<span data-ttu-id="6ca7b-262">Hay algunos desafíos al usar migraciones de Code First en un entorno de equipo.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-262">There are some challenges when using Code First Migrations in a team environment.</span></span> <span data-ttu-id="6ca7b-263">Sin embargo, un conocimiento básico del funcionamiento de las migraciones y algunos enfoques simple para resolver conflictos de combinación facilitan a superar estos desafíos.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-263">However, a basic understanding of how migrations works and some simple approaches for resolving merge conflicts make it easy to overcome these challenges.</span></span>

<span data-ttu-id="6ca7b-264">El problema fundamental es incorrecto metadatos almacenados en la migración más reciente.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-264">The fundamental issue is incorrect metadata stored in the latest migration.</span></span> <span data-ttu-id="6ca7b-265">Esto hace que Code First para detectar incorrectamente que el modelo actual y el esquema de base de datos no coinciden y para aplicar scaffolding a código incorrecto en la siguiente migración.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-265">This causes Code First to incorrectly detect that the current model and database schema don’t match and to scaffold incorrect code in the next migration.</span></span> <span data-ttu-id="6ca7b-266">Generando una migración en blanco con el modelo correcto, o bien actualizar los metadatos de la migración más reciente, se puede solucionar esta situación.</span><span class="sxs-lookup"><span data-stu-id="6ca7b-266">This situation can be overcome by generating a blank migration with the correct model, or updating the metadata in the latest migration.</span></span>
